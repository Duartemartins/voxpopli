<% content_for :title, "Voxpopli | The Voice of the People" %>

<% content_for :head do %>
  <meta name="description" content="A cyberpunk-themed community for indie hackers and builders. Share your journey, get feedback, and connect with other makers.">
  <link rel="canonical" href="<%= timeline_url %>">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Voxpopli | The Voice of the People">
  <meta property="og:description" content="A cyberpunk-themed community for indie hackers and builders. Share your journey, get feedback, and connect with other makers.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="<%= timeline_url %>">
  <meta property="og:image" content="<%= request.base_url %>/social-card.svg">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Voxpopli | The Voice of the People">
  <meta name="twitter:description" content="A cyberpunk-themed community for indie hackers and builders. Share your journey, get feedback, and connect with other makers.">
  <meta name="twitter:image" content="<%= request.base_url %>/social-card.svg">
<% end %>

<div class="space-y-8">
  <% if user_signed_in? %>
    <%= render 'posts/form' %>
  <% end %>

  <div class="flex gap-4 mb-2 overflow-x-auto">
    <% if user_signed_in? %>
      <%= link_to timeline_path(feed: 'following', view: params[:view]), 
          class: "font-mono text-xs px-2 py-1 border transition-all whitespace-nowrap #{@feed_type == 'following' ? 'border-acid-lime text-acid-lime bg-acid-lime/10' : 'border-steel text-ash hover:border-white hover:text-white'}" do %>
        // NETWORK
      <% end %>
    <% end %>
    
    <%= link_to timeline_path(feed: 'global', view: params[:view]), 
        class: "font-mono text-xs px-2 py-1 border transition-all whitespace-nowrap #{@feed_type == 'global' && @theme.nil? ? 'border-acid-lime text-acid-lime bg-acid-lime/10' : 'border-steel text-ash hover:border-white hover:text-white'}" do %>
      // GLOBAL
    <% end %>

    <% @themes.each do |theme| %>
      <%= link_to timeline_path(feed: 'global', theme: theme.slug, view: params[:view]), 
          class: "font-mono text-xs px-2 py-1 border transition-all whitespace-nowrap #{@theme == theme ? 'border-acid-lime text-acid-lime bg-acid-lime/10' : 'border-steel text-ash hover:border-white hover:text-white'}" do %>
        // <%= theme.name.upcase %>
      <% end %>
    <% end %>
  </div>

  <div class="flex gap-6 border-b border-steel pb-2">
    <%= link_to timeline_path(view: 'new', feed: params[:feed], theme: params[:theme]), 
        class: "font-mono text-xs uppercase tracking-widest pb-2 border-b-2 transition-all #{@view == 'new' ? 'border-acid-lime text-acid-lime' : 'border-transparent text-ash hover:text-white'}" do %>
      [ NEW_TRANSMISSIONS ]
    <% end %>
    
    <%= link_to timeline_path(view: 'voted', feed: params[:feed], theme: params[:theme]),
        class: "font-mono text-xs uppercase tracking-widest pb-2 border-b-2 transition-all #{@view == 'voted' ? 'border-acid-lime text-acid-lime' : 'border-transparent text-ash hover:text-white'}" do %>
      [ TOP_RATED ]
    <% end %>
  </div>

  <div id="posts" class="space-y-6">
    <%= render @posts %>
  </div>

  <% if @posts.empty? %>
    <div class="text-center py-16 border border-dashed border-steel bg-carbon/50">
      <p class="font-mono text-lg text-white mb-2">>> NO_DATA_FOUND</p>
      <% if user_signed_in? %>
        <p class="font-mono text-sm text-ash">Initiate first transmission sequence.</p>
      <% else %>
        <p class="font-mono text-sm text-ash">Authentication required to view data stream.</p>
      <% end %>
    </div>
  <% end %>

  <div class="mt-8 flex justify-center">
    <%= paginate @posts %>
  </div>
</div>

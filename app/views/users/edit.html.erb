<div class="max-w-2xl mx-auto mt-12 border border-steel bg-carbon p-8 shadow-[8px_8px_0_0_#333]">
  <h1 class="font-mono text-2xl font-bold text-white mb-8 tracking-tighter flex items-center gap-2">
    <span class="text-acid-lime">>></span> EDIT_PROFILE_DATA
  </h1>

  <%= form_with model: @user, url: user_path(@user.username), method: :patch, class: "space-y-8" do |form| %>
    <% if @user.errors.any? %>
      <div class="border border-acid-pink bg-acid-pink/10 p-4 font-mono text-sm text-acid-pink">
        <h2 class="font-bold mb-2 uppercase tracking-widest">
          >> ERROR_LOG: <%= pluralize(@user.errors.count, "ISSUE") %> DETECTED
        </h2>
        <ul class="list-disc list-inside">
          <% @user.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div>
      <%= form.label :display_name, "DISPLAY_NAME // ALIAS", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.text_field :display_name, 
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel",
          placeholder: "enter_alias..." %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Visible public identifier.</p>
    </div>

    <div>
      <%= form.label :tagline, "TAGLINE // ONE_LINER", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.text_field :tagline, 
          maxlength: 140,
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel",
          placeholder: "Building X to solve Y..." %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Short description for the builder directory. Max 140 chars.</p>
    </div>

    <div>
      <%= form.label :bio, "BIO_DATA // DESCRIPTION", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.text_area :bio, 
          rows: 4,
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel resize-none",
          placeholder: "enter_bio_data..." %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Brief operative summary.</p>
    </div>

    <div>
      <%= form.label :website, "NETWORK_LINK // WEBSITE", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.url_field :website, 
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel",
          placeholder: "https://..." %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">External network coordinate. Dofollow backlink included!</p>
    </div>

    <div>
      <%= form.label :github_username, "GITHUB_HANDLE", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <div class="flex">
        <span class="inline-flex items-center bg-obsidian border border-r-0 border-steel px-3 font-mono text-ash">@</span>
        <%= form.text_field :github_username, 
            class: "flex-1 bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel",
            placeholder: "username" %>
      </div>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Your GitHub username for profile linking.</p>
    </div>

    <div>
      <%= form.label :skills_list, "SKILLS // TAGS", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.text_field :skills_list, 
          value: @user.skills_list.join(", "),
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all placeholder-steel",
          placeholder: "Rails, JavaScript, AI, SaaS..." %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Comma-separated list of skills/technologies.</p>
    </div>

    <div>
      <%= form.label :looking_for, "LOOKING_FOR // STATUS", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <%= form.select :looking_for, 
          [["Not specified", ""]] + User::LOOKING_FOR_OPTIONS.map { |o| [o.titleize.gsub("_", " "), o] },
          {},
          class: "w-full bg-obsidian border border-steel text-white font-mono p-3 focus:border-acid-lime focus:outline-none focus:shadow-[0_0_10px_rgba(204,255,0,0.3)] transition-all" %>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">What are you currently looking for?</p>
    </div>

    <!-- Launched Products Section -->
    <div class="border-t border-steel pt-8" data-controller="products">
      <div class="flex items-center justify-between mb-4">
        <label class="font-mono text-xs text-acid-lime uppercase tracking-widest">LAUNCHED_PRODUCTS // PORTFOLIO</label>
        <button type="button" data-action="products#add" class="font-mono text-xs text-acid-cyan hover:text-white uppercase tracking-widest">
          [ + ADD_PRODUCT ]
        </button>
      </div>
      <p class="mb-4 font-mono text-[10px] text-ash uppercase">Showcase your launched products. Each gets a dofollow backlink!</p>
      
      <div data-products-target="container" class="space-y-4">
        <% @user.launched_products_list.each_with_index do |product, index| %>
          <div class="product-entry border border-steel p-4 bg-obsidian/50" data-controller="badge">
            <div class="flex items-start justify-between mb-3">
              <span class="font-mono text-xs text-acid-lime uppercase">PRODUCT_<%= index + 1 %></span>
              <div class="flex gap-4">
                <button type="button" data-action="click->badge#open" class="font-mono text-xs text-acid-cyan hover:text-white uppercase tracking-widest">
                  [ GET_BADGE ]
                </button>
                <button type="button" data-action="products#remove" class="font-mono text-xs text-acid-pink hover:text-white uppercase tracking-widest">
                  [ REMOVE ]
                </button>
              </div>
            </div>

            <dialog data-badge-target="modal" class="bg-carbon border border-acid-lime p-6 text-white shadow-[0_0_20px_rgba(204,255,0,0.2)] backdrop:bg-black/80 max-w-lg w-full m-auto">
              <div class="flex justify-between items-center mb-6">
                <h3 class="font-mono text-lg text-acid-lime">>> EMBED_BADGE_CODE</h3>
                <button type="button" data-action="click->badge#close" class="text-ash hover:text-white">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
              
              <p class="font-mono text-xs text-ash mb-4">Copy this code to your website to link back to your profile.</p>
              
              <div class="mb-6 flex justify-center bg-black p-8 border border-steel border-dashed">
                <!-- Preview -->
                <img src="/badges/featured.svg" alt="As Seen on Voxpopuli" />
              </div>

              <div class="relative">
                <textarea readonly class="w-full h-24 bg-obsidian border border-steel text-acid-lime font-mono text-xs p-4 mb-4 focus:outline-none focus:border-acid-lime resize-none" onclick="this.select()"><a href="<%= user_url(@user) %>" target="_blank" title="As Seen on Voxpopuli"><img src="<%= request.base_url %>/badges/featured.svg" alt="As Seen on Voxpopuli" width="200" height="50" /></a></textarea>
                <div class="absolute top-2 right-2 text-[10px] text-ash uppercase pointer-events-none">HTML</div>
              </div>
              
              <div class="flex justify-end">
                <button type="button" data-action="click->badge#close" class="font-mono text-xs text-white hover:text-acid-lime uppercase border border-steel px-4 py-2 hover:border-acid-lime transition-all">
                  [ CLOSE_TERMINAL ]
                </button>
              </div>
            </dialog>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">NAME</label>
                <%= text_field_tag "user[launched_products_attributes][#{index}][name]", product["name"],
                    class: "w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none",
                    placeholder: "Product name..." %>
              </div>
              
              <div>
                <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">URL</label>
                <%= url_field_tag "user[launched_products_attributes][#{index}][url]", product["url"],
                    class: "w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none",
                    placeholder: "https://..." %>
              </div>
              
              <div class="md:col-span-2">
                <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">DESCRIPTION</label>
                <%= text_field_tag "user[launched_products_attributes][#{index}][description]", product["description"],
                    class: "w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none",
                    placeholder: "Brief description..." %>
              </div>
              
              <div>
                <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">MRR (OPTIONAL)</label>
                <%= number_field_tag "user[launched_products_attributes][#{index}][mrr]", product["mrr"],
                    class: "w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none",
                    placeholder: "Monthly revenue in $",
                    min: 0 %>
              </div>
              
              <div class="flex items-center gap-2">
                <%= check_box_tag "user[launched_products_attributes][#{index}][revenue_confirmed]", "1", product["revenue_confirmed"],
                    class: "w-4 h-4 bg-obsidian border border-steel text-acid-lime focus:ring-acid-lime" %>
                <label class="font-mono text-[10px] text-ash uppercase tracking-widest">REVENUE_CONFIRMED</label>
              </div>
            </div>
          </div>
        <% end %>
      </div>
      
      <% if @user.launched_products_list.empty? %>
        <div data-products-target="empty" class="text-center py-8 border border-dashed border-steel">
          <p class="font-mono text-xs text-ash">>> NO_PRODUCTS_ADDED</p>
          <p class="font-sans text-xs text-ash mt-1">Click "ADD_PRODUCT" to showcase your work.</p>
        </div>
      <% end %>
      
      <!-- Template for new products -->
      <template data-products-target="template">
        <div class="product-entry border border-steel p-4 bg-obsidian/50">
          <div class="flex items-start justify-between mb-3">
            <span class="font-mono text-xs text-acid-lime uppercase">NEW_PRODUCT</span>
            <button type="button" data-action="products#remove" class="font-mono text-xs text-acid-pink hover:text-white uppercase tracking-widest">
              [ REMOVE ]
            </button>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">NAME</label>
              <input type="text" name="user[launched_products_attributes][NEW_INDEX][name]"
                  class="w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none"
                  placeholder="Product name...">
            </div>
            
            <div>
              <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">URL</label>
              <input type="url" name="user[launched_products_attributes][NEW_INDEX][url]"
                  class="w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none"
                  placeholder="https://...">
            </div>
            
            <div class="md:col-span-2">
              <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">DESCRIPTION</label>
              <input type="text" name="user[launched_products_attributes][NEW_INDEX][description]"
                  class="w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none"
                  placeholder="Brief description...">
            </div>
            
            <div>
              <label class="block font-mono text-[10px] text-ash uppercase tracking-widest mb-1">MRR (OPTIONAL)</label>
              <input type="number" name="user[launched_products_attributes][NEW_INDEX][mrr]"
                  class="w-full bg-obsidian border border-steel text-white font-mono p-2 text-sm focus:border-acid-lime focus:outline-none"
                  placeholder="Monthly revenue in $"
                  min="0">
            </div>
            
            <div class="flex items-center gap-2">
              <input type="checkbox" name="user[launched_products_attributes][NEW_INDEX][revenue_confirmed]" value="1"
                  class="w-4 h-4 bg-obsidian border border-steel text-acid-lime focus:ring-acid-lime">
              <label class="font-mono text-[10px] text-ash uppercase tracking-widest">REVENUE_CONFIRMED</label>
            </div>
          </div>
        </div>
      </template>
    </div>

    <div>
      <%= form.label :avatar, "IMG_SOURCE // AVATAR_UPLOAD", class: "block font-mono text-xs text-acid-lime mb-2 uppercase tracking-widest" %>
      <div class="flex items-center gap-4">
        <%= user_avatar(@user, classes: "w-16 h-16") %>
        <%= form.file_field :avatar, 
            class: "block w-full text-sm text-ash file:mr-4 file:py-2 file:px-4 file:border file:border-steel file:bg-obsidian file:text-acid-lime file:font-mono file:text-xs file:uppercase file:tracking-widest hover:file:bg-steel/20 file:cursor-pointer cursor-pointer" %>
      </div>
      <p class="mt-1 font-mono text-[10px] text-ash uppercase">Upload profile image. Max 5MB.</p>
    </div>

    <div class="pt-4 border-t border-steel flex items-center justify-end gap-4">
      <%= link_to "CANCEL_EDIT", user_path(@user.username), class: "font-mono text-xs text-ash hover:text-white uppercase tracking-widest" %>
      <%= form.submit "SAVE_PROFILE_DATA", class: "bg-acid-lime text-obsidian font-mono font-bold uppercase tracking-widest px-6 py-3 hover:bg-white hover:shadow-[4px_4px_0_0_#FFF] transition-all cursor-pointer border-none" %>
    </div>
  <% end %>
</div>
